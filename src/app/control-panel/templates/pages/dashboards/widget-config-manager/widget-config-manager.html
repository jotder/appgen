<div class="widget-config-manager">
  <div class="master-pane">
    <h2>Widget Configurations</h2>
    <div *ngIf="loading()">Loading...</div>
    <ul>
      <li *ngFor="let config of configs()" (click)="select(config)" [class.selected]="config.id === selected()?.id">
        {{ config.name }} ({{ config.widgetType }})
      </li>
    </ul>
    <button (click)="newConfig()">New Config</button>
  </div>

  <div class="detail-pane" *ngIf="selected() as config">
    <h3>{{ config.name }}</h3>
    <div class="config-form">
      <div>
        <label>Name:</label>
        <input [value]="config.name" (input)="config.name = $any($event.target).value">
      </div>
      <div>
        <label>Type:</label>
        <select [value]="config.widgetType" (change)="config.widgetType = $any($event.target).value" [disabled]="!creating()">
          <option *ngFor="let type of types.list()" [value]="type.id">{{ type.name }}</option>
        </select>
      </div>

      <h4>Parameters</h4>
      <app-json-schema-form [schema]="schemaOfSelected()" [(formData)]="formParams"></app-json-schema-form>

      <div class="actions">
        <button (click)="save()">Save</button>
        <button (click)="remove(config)" *ngIf="!creating()">Delete</button>
        <button (click)="usage(config)" *ngIf="!creating()">Check Usage</button>
      </div>
    </div>
  </div>
</div>
